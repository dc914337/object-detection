
resolution: &resolution 36
patch_size: &patch_size 3
num_classes: &num_classes 4


model_class:  VIT_MADVERSARY_2

model:
  image_size: *resolution
  patch_size: *patch_size
  num_classes: *num_classes

  # masker
  masker:
    image_size: *resolution
    patch_size: *patch_size

    num_hidden_layers: 3
    num_attention_heads: 4
    hidden_size: 128

    intermediate_size: 260

    decoder_intermediate_size: 130
    decoder_num_hidden_layers: 3
    decoder_num_attention_heads: 4
    decoder_hidden_size: 128

    # custom parameter
    decoder_num_classes: 4

    pretrained_path: null
    #pretrained_path: "./checkpoints/whole recon both/masker_madversary_2_294000.pt"
    #pretrained_path: "./checkpoints/softmax masker/masker_madversary_2_2000.pt"

  # reconstructor
  reconstructor:
    image_size: *resolution
    patch_size: *patch_size

    num_hidden_layers: 3
    num_attention_heads: 4
    hidden_size: 128

    intermediate_size: 260

    decoder_intermediate_size: 130
    decoder_num_hidden_layers: 3
    decoder_num_attention_heads: 4
    decoder_hidden_size: 128

    #pretrained_path: null
    #pretrained_path: "./checkpoints/whole recon both/recon_madversary_2_222000.pt"
    #pretrained_path: "./checkpoints/softmax recon/recon_madversary_2_1000.pt"
    #pretrained_path: "./checkpoints/tiny recon/recon_madversary_2_10000.pt"
    #pretrained_path: "./checkpoints/tiny recon/recon_madversary_2_25000.pt"
    #pretrained_path: "./checkpoints/tiny recon/recon_madversary_2_35000.pt"
    pretrained_path: "./checkpoints/whole tiny recon/recon_madversary_2_38000.pt"
    #pretrained_path: "./checkpoints/recon_madversary_2_11000.pt"


  object_size: 0.08 #0.5 #0.18
  temperature: 0.05
  lr: 1.e-4
  warmup_steps: 1000
  decay_rate: 0.7
  decay_steps: 2000000
  norm_pix_loss: False

# training
total_iter: 300000
visualize_freq: 300

switch_training_recon_masker_steps: 300

eval_epoch_freq: 100
dataset_path: "data/EMORL/tetrominoes.h5"
test_dataset_path: "data/EMORL/tetrominoes_test.h5"
batch_size: 60
DEBUG: False

notes: "Train adversarial from scratch"
train_recon: True